server:
  port: 8000
  shutdown: graceful

spring:
  application:
    name: gateway-service
  cloud:
    gateway:
      routes:
        # --- 1. Auth Service Route ---
        # Public endpoints (login/register/validate)
        - id: auth-service
          uri: http://auth-service:8080
          predicates:
            - Path=/auth-service/api/v1/auth/**

        # --- 2. User Service Route ---
        # Protected endpoints requiring a valid JWT
        - id: user-service
          uri: http://user-service:8081
          predicates:
            - Path=/user-service/api/v1/users/**
          filters:
            - AuthenticationFilter

        # --- 3. Course Service Route ---
        - id: course-service
          uri: http://course-service:8082
          predicates:
            - Path=/course-service/api/v1/courses/**
          filters:
            - AuthenticationFilter

        # --- 4. Order Service Route (NEW) ---
        # Routes checkout and order history requests
        - id: order-service
          uri: http://order-service:8084
          predicates:
            - Path=/order-service/api/v1/orders/**
          filters:
            - AuthenticationFilter

management:
  endpoints:
    web:
      exposure:
        # Expose only health for security; metrics/info can be added later
        include: health
  endpoint:
    health:
      # Enables /actuator/health/liveness and /actuator/health/readiness
      probes:
        enabled: true
      # Shows detailed health info (useful for debugging, can be restricted in prod)
      show-details: always

# --- Custom App Settings ---
app:
  services:
    # URL for token validation in auth-service
    auth-validation-url: http://auth-service:8080/auth-service/api/v1/auth/validate